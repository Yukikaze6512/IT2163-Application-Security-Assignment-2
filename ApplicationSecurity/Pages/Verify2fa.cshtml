@page
@model ApplicationSecurity.Pages.Verify2faModel
@{
    Layout = "_AuthLayout";
    ViewData["Title"] = "Two-Factor Verification";
}

<div class="auth-form-box">
    <h1 class="page-title mb-1">Two-factor verification</h1>
    <p class="page-desc mb-4">Enter the 6-digit code from your authenticator app.</p>

    @if (!ViewData.ModelState.IsValid)
    {
        <div class="alert alert-danger mb-3">
            <i data-lucide="circle-alert" class="alert-icon"></i>
            <div>
                <div class="alert-title">Verification failed</div>
                <div asp-validation-summary="All"></div>
            </div>
        </div>
    }

    <form method="post" id="verify2faForm">
        <input type="hidden" name="Input.Code" id="otpHidden" />
        <div class="mb-4">
            <fieldset class="form-otp otp-lg" id="verifyOtp" aria-label="Verification code">
                <input class="otp-c" type="text">
                <input class="otp-c" type="text">
                <input class="otp-c" type="text">
                <span class="otp-sep">&ndash;</span>
                <input class="otp-c" type="text">
                <input class="otp-c" type="text">
                <input class="otp-c" type="text">
            </fieldset>
            <span asp-validation-for="Input.Code" class="text-danger d-block text-center mt-1"></span>
        </div>
        <button type="submit" class="btn btn-p w-100" id="verifyBtn">Verify</button>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        initOtp('#verifyOtp', 'Input.Code', { type:'number', placeholder:'0' });
        document.getElementById('verify2faForm').addEventListener('submit', function () {
            var b = document.getElementById('verifyBtn'); b.disabled = true; b.textContent = 'Verifying\u2026';
        });
    </script>
}